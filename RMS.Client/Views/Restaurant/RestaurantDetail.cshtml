@using System.Web.Optimization
@model RMS.Client.Models.View.RestaurantModel

@{
    ViewBag.Title = "RestaurantDetail";
    Layout = "~/Views/Shared/_BaseLayout.cshtml";
}


<!--=== Content Part ===-->
<div class="container content">
    <div class="row">
        <!-- Left Sidebar -->
        <div class="col-md-12 md-margin-bottom-60">
            <!--Blog Post-->
            <div class="blog margin-bottom-60">
                <h1>@Html.DisplayFor(model => model.Name), <small>Alabama</small></h1>

                <div class="list-group-item-text " style="padding: 10px;">
                    <ul class="list-unstyled list-inline ">
                        <li>
                        @for (int i = 0; i < Model.Rating; i++)
                        {
                            <span>
                                <i class="fa fa-star color-green"></i>
                            </span>
                        }
                        </li>
                        <li><i class="fa fa-comment-o"></i>
                            @Model.CommentCount reviews</li>
                        <button id="btnFavorite" class="pull-right btn btn-default "><i class="fa fa-thumbs-up">Add to Favorites</i></button>
                    </ul>
                </div>

                <div class="row">
                    <div class="col-md-9">
                        <img class="img-responsive" src="@Url.Content(Model.PhotoUrl ?? ' '.ToString())" alt="">
                    </div>

                </div>
                <h2 class="margin-top-20"><b>About @Model.Name</b></h2>
                <hr />
                <div class="col-md-8">
                    <p>
                        @Html.DisplayFor(model => model.Description)
                    </p>
                </div>
                <div class="col-md-3">
                    <ul class="list-unstyled bg-grey" style="padding: 20px">
                        <li>
                            <address>
                                <i class="fa fa-location-arrow"></i>
                                507 Calles Street
                                Austin, TX, 78702
                            </address>
                        </li>
                        <li><i class="fa fa-phone"></i>@Model.Phone</li>
                    </ul>
                </div>
                <div class="col-md-12 ">
                    @*<a href="@Url.Action("BookTable", new { @Id = Model.Id })" class="btn btn-lg btn-primary centered" >Make reservation</a>*@

                </div>

            </div>
            <!--End Blog Post-->

            <div class="col-md-12">
                <hr>
                <div id="comment"></div>
                <hr>
            </div>

            <div class="col-md-12">
                <!-- Comment Form -->
                <div class="comment-form"></div>
                <!-- End Comment Form -->
            </div>
        </div>
        <!-- End Left Sidebar -->

    </div>
    <!--/row-->
</div>
<!--/container-->
<!--=== End Content Part ===-->

<button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Make reservation</button>

<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Make reservation</h4>
      </div>
        <div class="modal-body">
            <div class="">
                <div id="book-table-context"></div>            
            </div>
        </div>
      <div class="modal-footer">
        
      </div>
    </div>

  </div>
</div>

@section Scripts {

    <script>
        require(["jquery",
                "Custom/EventTrigger",
                "Widgets/commentLstCtrl/commentLstCtrl",
                "Widgets/commentCtrl/commentCtrl",
                "Widgets/bookingCtrl/bookingCtrl"
                ],
            function ($) {
                
                
                $(document).ready(function () {
                    var eventTrigger = new EventTrigger();
                    $("#comment").commentList({ RestaurantId: "@Model.Id", eventTrigger: eventTrigger });
                    $('.comment-form').comment({ restaurantId: "@Model.Id", eventTrigger: eventTrigger });
                    $('#book-table-context').booking({ restaurantId: "@Model.Id" });
                    
                $('#btnFavorite').on('click', function () {
                    $.ajax({
                        type: 'POST',
                        url: '/Restaurant/AddFavorite/' + '@Model.Id',
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function () {
                            console.log('AddFavorite: success');
                        },
                        error: function (err) {
                            console.log(err.status + " : " + err.statusText);
                        }
                    });
                });
            });
            });
    </script>
}